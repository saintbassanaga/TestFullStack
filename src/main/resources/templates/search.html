<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <title>Search Products</title>
    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.9.3"></script>

    <!-- WebAwesome UI -->
    <link rel="stylesheet" href="https://early.webawesome.com/webawesome@3.0.0-beta.4/dist/styles/webawesome.css"/>
    <script type="module" src="https://early.webawesome.com/webawesome@3.0.0-beta.4/dist/webawesome.loader.js"></script>

    <style>
        .htmx-indicator {
            display: none;
        }

        .htmx-request .htmx-indicator {
            display: inline-block;
        }
        td {
            max-width: 200px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        html, body {
            height: 100%;
            margin: 0;
        }

        .page-center {
            display: block;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 2rem;
            box-sizing: border-box;
        }



    </style>
</head>
<body class="wa-body page-center">

<header class="wa-mb--lg">
    <h1>Search Products</h1>
    <a href="/" class="wa-link">Back to Home</a>
</header>

<!-- Controls: Search + Sort -->
<div class="wa-stack wa-stack--row wa-gap--md wa-mb--md">
    <div class="wa-form-group">
        <label>
            Search by title
            <div class="wa-token-input">
                <input
                        id="searchInput"
                        class="wa-input"
                        type="text"
                        name="q"
                        placeholder="Type to search..."
                        hx-get="/products/search"
                        hx-trigger="keyup changed delay:300ms, search"
                        hx-target="#products-table"
                        hx-swap="outerHTML"
                        hx-include="#sort"
                />
            </div>
        </label>
        <span class="htmx-indicator">Searching...</span>
    </div>
</div>
    <label class="wa-form-group">
        Sort by
        <select id="sort" name="sort" class="wa-select"
                hx-get="/products/search"
                hx-trigger="change"
                hx-target="#products-table"
                hx-swap="outerHTML"
                hx-include="#searchInput">
            <option value="newest" selected>Newest</option>
            <option value="priceAsc">Price: Low to High</option>
            <option value="priceDesc">Price: High to Low</option>
        </select>
    </label>
</div>

<!-- Results Table -->
<div id="products-table" th:replace="fragments/products :: table"></div>

</body>
</html>
